<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KursGenerator Pro - Automatische Kurserstellung</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-video text-purple-600 text-2xl"></i>
                    <h1 class="text-xl font-bold text-gray-800">KursGenerator Pro</h1>
                </div>
                <div id="userNav" class="hidden items-center space-x-4">
                    <span id="userName" class="text-gray-600"></span>
                    <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                        <i class="fas fa-sign-out-alt mr-2"></i>Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="min-h-screen">
        <!-- Login/Register Screen -->
        <div id="authScreen" class="flex items-center justify-center min-h-screen bg-gradient-to-br from-purple-600 to-blue-600">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
                <div class="text-center mb-8">
                    <i class="fas fa-video text-purple-600 text-5xl mb-4"></i>
                    <h2 class="text-2xl font-bold text-gray-800">KursGenerator Pro</h2>
                    <p class="text-gray-600">Verwandle Videos in professionelle Kurse</p>
                </div>

                <!-- Login Form -->
                <div id="loginForm">
                    <h3 class="text-xl font-semibold mb-4">Anmelden</h3>
                    <form onsubmit="login(event)">
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Email
                            </label>
                            <input type="email" id="loginEmail" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Passwort
                            </label>
                            <input type="password" id="loginPassword" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <button type="submit" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700">
                            Anmelden
                        </button>
                    </form>
                    <p class="text-center mt-4">
                        <span class="text-gray-600">Noch kein Account? </span>
                        <button onclick="showRegister()" class="text-purple-600 hover:underline">Registrieren</button>
                    </p>
                </div>

                <!-- Register Form -->
                <div id="registerForm" class="hidden">
                    <h3 class="text-xl font-semibold mb-4">Registrieren</h3>
                    <form onsubmit="register(event)">
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Name
                            </label>
                            <input type="text" id="registerName" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Email
                            </label>
                            <input type="email" id="registerEmail" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Passwort
                            </label>
                            <input type="password" id="registerPassword" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                        <button type="submit" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700">
                            Registrieren
                        </button>
                    </form>
                    <p class="text-center mt-4">
                        <span class="text-gray-600">Bereits registriert? </span>
                        <button onclick="showLogin()" class="text-purple-600 hover:underline">Anmelden</button>
                    </p>
                </div>
            </div>
        </div>

        <!-- Payment Screen -->
        <div id="paymentScreen" class="hidden flex items-center justify-center min-h-screen bg-gradient-to-br from-green-600 to-blue-600">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
                <div class="text-center mb-8">
                    <i class="fas fa-crown text-yellow-500 text-5xl mb-4"></i>
                    <h2 class="text-2xl font-bold text-gray-800">KursGenerator Pro</h2>
                    <p class="text-gray-600">Einmalige Zahlung für lebenslangen Zugang</p>
                </div>
                
                <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 rounded-lg text-white mb-6">
                    <h3 class="text-xl font-bold mb-2">Pro-Version</h3>
                    <div class="text-3xl font-bold mb-4">799€</div>
                    <ul class="space-y-2 text-sm">
                        <li><i class="fas fa-check mr-2"></i>Unbegrenzte Video-Verarbeitung</li>
                        <li><i class="fas fa-check mr-2"></i>KI-basierte Kurserstellung</li>
                        <li><i class="fas fa-check mr-2"></i>PDF-Export</li>
                        <li><i class="fas fa-check mr-2"></i>Quiz-Generierung</li>
                        <li><i class="fas fa-check mr-2"></i>Lebenslanger Zugang</li>
                    </ul>
                </div>

                <div id="card-element" class="p-3 border rounded-lg mb-4"></div>
                <div id="card-errors" role="alert" class="text-red-500 text-sm mb-4"></div>
                
                <button id="submit-payment" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 font-semibold">
                    <i class="fas fa-lock mr-2"></i>Jetzt für 799€ kaufen
                </button>
                
                <p class="text-xs text-gray-500 text-center mt-4">
                    Sichere Zahlung über Stripe • 30 Tage Geld-zurück-Garantie
                </p>
            </div>
        </div>

        <!-- Main App Screen -->
        <div id="appScreen" class="hidden">
            <!-- Dashboard -->
            <div id="dashboard" class="max-w-7xl mx-auto px-4 py-8">
                <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-tachometer-alt text-purple-600 mr-2"></i>Dashboard
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-6 rounded-lg text-white">
                            <i class="fas fa-video text-2xl mb-2"></i>
                            <h3 class="text-xl font-semibold">Neuen Kurs erstellen</h3>
                            <p class="mt-2 opacity-90">Video hochladen und automatisch in Kurs verwandeln</p>
                            <button onclick="showUpload()" class="mt-4 bg-white text-purple-600 px-4 py-2 rounded font-semibold hover:bg-gray-100">
                                Los geht's
                            </button>
                        </div>
                        <div class="bg-gradient-to-r from-green-500 to-teal-600 p-6 rounded-lg text-white">
                            <i class="fas fa-book text-2xl mb-2"></i>
                            <h3 class="text-xl font-semibold">Meine Kurse</h3>
                            <p class="mt-2 opacity-90">Bereits erstellte Kurse verwalten</p>
                            <button onclick="showCourses()" class="mt-4 bg-white text-green-600 px-4 py-2 rounded font-semibold hover:bg-gray-100">
                                Anzeigen
                            </button>
                        </div>
                        <div class="bg-gradient-to-r from-orange-500 to-red-600 p-6 rounded-lg text-white">
                            <i class="fas fa-cog text-2xl mb-2"></i>
                            <h3 class="text-xl font-semibold">Einstellungen</h3>
                            <p class="mt-2 opacity-90">API-Keys und Konfiguration</p>
                            <button onclick="showSettings()" class="mt-4 bg-white text-orange-600 px-4 py-2 rounded font-semibold hover:bg-gray-100">
                                Konfigurieren
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div id="uploadSection" class="hidden max-w-4xl mx-auto px-4 py-8">
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-cloud-upload-alt text-purple-600 mr-2"></i>Video hochladen
                    </h2>
                    
                    <!-- Upload Form -->
                    <div id="uploadForm">
                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Kurs-Titel
                            </label>
                            <input type="text" id="courseTitle" placeholder="z.B. Online Marketing Masterclass" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>

                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Kapitel-Länge (Minuten)
                            </label>
                            <div class="flex items-center space-x-4">
                                <span class="text-sm text-gray-500">3 min</span>
                                <input type="range" id="chapterLength" min="3" max="40" value="15" class="flex-1" oninput="updateChapterLength()">
                                <span class="text-sm text-gray-500">40 min</span>
                            </div>
                            <div class="text-center mt-2">
                                <span id="chapterLengthValue" class="text-lg font-semibold text-purple-600">15 Minuten</span>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Optionen
                            </label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="generateLearningGoals" checked class="mr-2">
                                    <span>Lernziele generieren</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="detailedSummary" checked class="mr-2">
                                    <span>Ausführliche Zusammenfassungen</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="generateQuiz" checked class="mr-2">
                                    <span>Quiz-Fragen erstellen</span>
                                </label>
                            </div>
                        </div>

                        <!-- Video Upload Area -->
                        <div class="mb-6">
                            <div id="dropZone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-purple-500 transition-colors cursor-pointer">
                                <i class="fas fa-cloud-upload-alt text-6xl text-gray-400 mb-4"></i>
                                <p class="text-xl text-gray-600 mb-2">Video hier ablegen oder klicken zum Auswählen</p>
                                <p class="text-sm text-gray-500">Unterstützt: MP4, MOV, AVI (max. 3 Stunden)</p>
                                <input type="file" id="videoFile" accept="video/*" class="hidden" onchange="handleFileSelect(event)">
                            </div>
                        </div>

                        <!-- Selected File Info -->
                        <div id="fileInfo" class="hidden mb-6 p-4 bg-blue-50 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-video text-blue-600 mr-2"></i>
                                    <span id="fileName" class="font-medium"></span>
                                </div>
                                <span id="fileSize" class="text-sm text-gray-500"></span>
                            </div>
                        </div>

                        <button onclick="startProcessing()" class="w-full bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 font-semibold text-lg">
                            <i class="fas fa-magic mr-2"></i>Kurs erstellen
                        </button>
                    </div>

                    <!-- Processing Screen -->
                    <div id="processingScreen" class="hidden text-center">
                        <div class="mb-8">
                            <i class="fas fa-cog fa-spin text-6xl text-purple-600 mb-4"></i>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Kurs wird erstellt...</h3>
                            <p class="text-gray-600">Das kann 5-15 Minuten dauern. Bitte warten Sie.</p>
                        </div>

                        <div class="bg-gray-200 rounded-full h-4 mb-4">
                            <div id="progressBar" class="bg-purple-600 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>

                        <div id="progressSteps" class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span>Video analysieren...</span>
                                <i id="step1" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Audio extrahieren...</span>
                                <i id="step2" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Transkription erstellen...</span>
                                <i id="step3" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Kapitel generieren...</span>
                                <i id="step4" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Lernziele erstellen...</span>
                                <i id="step5" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>Quiz generieren...</span>
                                <i id="step6" class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>PDFs erstellen...</span>
                                <i id="step7" class="fas fa-clock text-gray-400"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Results Screen -->
                    <div id="resultsScreen" class="hidden">
                        <div class="text-center mb-8">
                            <i class="fas fa-check-circle text-6xl text-green-600 mb-4"></i>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Kurs erfolgreich erstellt!</h3>
                            <p class="text-gray-600">Ihr professioneller Online-Kurs ist bereit.</p>
                        </div>

                        <div id="courseResults" class="space-y-4">
                            <!-- Results will be populated here -->
                        </div>

                        <div class="mt-8 text-center">
                            <button onclick="downloadAllFiles()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 mr-4">
                                <i class="fas fa-download mr-2"></i>Alle Dateien herunterladen
                            </button>
                            <button onclick="createNewCourse()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700">
                                <i class="fas fa-plus mr-2"></i>Neuen Kurs erstellen
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settingsSection" class="hidden max-w-4xl mx-auto px-4 py-8">
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-cog text-purple-600 mr-2"></i>Einstellungen
                    </h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                OpenAI API Key
                            </label>
                            <input type="password" id="openaiKey" placeholder="sk-..." class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                            <p class="text-xs text-gray-500 mt-1">Benötigt für KI-basierte Transkription und Kurserstellung</p>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Zusammenfassung-Stil
                            </label>
                            <select id="summaryStyle" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                <option value="detailed">Ausführlich</option>
                                <option value="concise">Prägnant</option>
                                <option value="bullet">Stichpunkte</option>
                            </select>
                        </div>
                        
                        <button onclick="saveSettings()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Einstellungen speichern
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const OPENAI_API_KEY = 'sk-DEIN_OPENAI_KEY_HIER'; // Replace with your OpenAI API key
        const STRIPE_PUBLISHABLE_KEY = '
pk_test_51RtGtBFyPoyZB9S8hugCjBe1hMqQAg7bkbHRhdU8SkfCOuTB7Yjh2iK5hbaW9jQgoNWhZCkeh8ju9p35Fkrg7hrn00Ce1yKEnF'; // Replace with your Stripe publishable key
        
        // Initialize Stripe
        const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);
        const elements = stripe.elements();
        let card;

        // Current user and selected file
        let currentUser = null;
        let selectedFile = null;
        let currentCourse = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            checkUserStatus();
            setupDropZone();
            setupPaymentForm();
        });

        // Authentication functions
        function checkUserStatus() {
            const user = localStorage.getItem('currentUser');
            const hasPaid = localStorage.getItem('hasPaid');
            
            if (user) {
                currentUser = JSON.parse(user);
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userNav').classList.remove('hidden');
                document.getElementById('userNav').classList.add('flex');
                
                if (hasPaid === 'true') {
                    showApp();
                } else {
                    showPayment();
                }
            } else {
                showAuth();
            }
        }

        function showAuth() {
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('paymentScreen').classList.add('hidden');
            document.getElementById('appScreen').classList.add('hidden');
        }

        function showPayment() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('paymentScreen').classList.remove('hidden');
            document.getElementById('appScreen').classList.add('hidden');
        }

        function showApp() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('paymentScreen').classList.add('hidden');
            document.getElementById('appScreen').classList.remove('hidden');
            showDashboard();
        }

        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('registerForm').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
        }

        function login(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple authentication (in production, use proper authentication)
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                checkUserStatus();
            } else {
                alert('Ungültige Anmeldedaten');
            }
        }

        function register(event) {
            event.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            if (users.find(u => u.email === email)) {
                alert('Email bereits registriert');
                return;
            }
            
            const newUser = { name, email, password, id: Date.now() };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            checkUserStatus();
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            showAuth();
        }

        // Payment functions
        function setupPaymentForm() {
            if (!stripe || !elements) return;
            
            const style = {
                base: {
                    fontSize: '16px',
                    color: '#424770',
                    '::placeholder': {
                        color: '#aab7c4',
                    },
                },
            };

            card = elements.create('card', { style: style });
            card.mount('#card-element');

            card.on('change', ({ error }) => {
                const displayError = document.getElementById('card-errors');
                if (error) {
                    displayError.textContent = error.message;
                } else {
                    displayError.textContent = '';
                }
            });

            document.getElementById('submit-payment').addEventListener('click', handlePayment);
        }

        async function handlePayment() {
            const { token, error } = await stripe.createToken(card);

            if (error) {
                document.getElementById('card-errors').textContent = error.message;
            } else {
                // Simulate successful payment
                localStorage.setItem('hasPaid', 'true');
                localStorage.setItem('paymentToken', token.id);
                showApp();
                alert('Zahlung erfolgreich! Willkommen bei KursGenerator Pro!');
            }
        }

        // App navigation
        function showDashboard() {
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
        }

        function showUpload() {
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('uploadSection').classList.remove('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
            resetUploadForm();
        }

        function showSettings() {
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('settingsSection').classList.remove('hidden');
            loadSettings();
        }

        function showCourses() {
            alert('Meine Kurse Feature kommt bald!');
        }

        // File upload functions
        function setupDropZone() {
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('videoFile');

            dropZone.addEventListener('click', () => fileInput.click());
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('drop', handleDrop);
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.currentTarget.classList.add('border-purple-500');
        }

        function handleDrop(event) {
            event.preventDefault();
            event.currentTarget.classList.remove('border-purple-500');
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelect({ target: { files } });
            }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('video/')) {
                selectedFile = file;
                displayFileInfo(file);
            } else {
                alert('Bitte wählen Sie eine gültige Videodatei aus.');
            }
        }

        function displayFileInfo(file) {
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('fileInfo').classList.remove('hidden');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function updateChapterLength() {
            const value = document.getElementById('chapterLength').value;
            document.getElementById('chapterLengthValue').textContent = value + ' Minuten';
        }

        // Course processing functions
        async function startProcessing() {
            if (!selectedFile) {
                alert('Bitte wählen Sie zuerst eine Videodatei aus.');
                return;
            }

            const title = document.getElementById('courseTitle').value || 'Mein Kurs';
            const chapterLength = parseInt(document.getElementById('chapterLength').value);
            const generateLearningGoals = document.getElementById('generateLearningGoals').checked;
            const detailedSummary = document.getElementById('detailedSummary').checked;
            const generateQuiz = document.getElementById('generateQuiz').checked;

            document.getElementById('uploadForm').classList.add('hidden');
            document.getElementById('processingScreen').classList.remove('hidden');

            try {
                await simulateProcessing();
                const courseData = await generateCourse(title, chapterLength, generateLearningGoals, detailedSummary, generateQuiz);
                showResults(courseData);
            } catch (error) {
                console.error('Processing error:', error);
                alert('Fehler bei der Verarbeitung. Bitte versuchen Sie es erneut.');
                resetUploadForm();
            }
        }

        async function simulateProcessing() {
            const steps = ['step1', 'step2', 'step3', 'step4', 'step5', 'step6', 'step7'];
            const progressBar = document.getElementById('progressBar');

            for (let i = 0; i < steps.length; i++) {
                await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 3000));
                
                const stepElement = document.getElementById(steps[i]);
                stepElement.className = 'fas fa-check text-green-500';
                
                const progress = ((i + 1) / steps.length) * 100;
                progressBar.style.width = progress + '%';
            }
        }

        async function generateCourse(title, chapterLength, generateLearningGoals, detailedSummary, generateQuiz) {
            // Simulate course generation with mock data
            const mockTranscript = `
                In diesem Video sprechen wir über die Grundlagen des Online Marketings.
                Zunächst schauen wir uns die verschiedenen Kanäle an: Social Media, E-Mail Marketing, SEO und bezahlte Werbung.
                Social Media Marketing ist besonders wichtig für die Markenbildung und Kundenbindung.
                E-Mail Marketing hat noch immer eine der höchsten Conversion-Raten.
                Suchmaschinenoptimierung hilft dabei, organisch gefunden zu werden.
                Bezahlte Werbung kann schnelle Ergebnisse liefern, erfordert aber Budget.
                Wichtig ist eine integrierte Strategie, die alle Kanäle miteinander verbindet.
                Messen Sie regelmäßig Ihre Erfolge mit Analytics-Tools.
                Testen Sie verschiedene Ansätze und optimieren Sie kontinuierlich.
                Der Schlüssel zum Erfolg liegt in der Konsistenz und Geduld.
            `;

            const chapters = [
                {
                    title: "Einführung ins Online Marketing",
                    duration: chapterLength,
                    summary: detailedSummary ? 
                        "In diesem Kapitel lernen Sie die Grundlagen des Online Marketings kennen. Wir besprechen die wichtigsten Kanäle wie Social Media, E-Mail Marketing, SEO und bezahlte Werbung. Sie erfahren, wie diese Kanäle funktionieren und welche Vorteile sie bieten." :
                        "Grundlagen des Online Marketings und wichtigste Kanäle.",
                    learningGoals: generateLearningGoals ? [
                        "Die wichtigsten Online Marketing Kanäle benennen können",
                        "Vor- und Nachteile verschiedener Kanäle verstehen",
                        "Eine grundlegende Marketing-Strategie entwickeln"
                    ] : [],
                    quiz: generateQuiz ? [
                        {
                            question: "Welcher Online Marketing Kanal hat die höchste Conversion-Rate?",
                            options: ["Social Media", "E-Mail Marketing", "SEO", "Bezahlte Werbung"],
                            correct: 1,
                            explanation: "E-Mail Marketing hat noch immer eine der höchsten Conversion-Raten."
                        }
                    ] : []
                },
                {
                    title: "Social Media Marketing",
                    duration: chapterLength,
                    summary: detailedSummary ?
                        "Social Media Marketing ist essentiell für moderne Unternehmen. Es ermöglicht direkte Kommunikation mit Kunden, Markenaufbau und Community-Building. Wir behandeln die wichtigsten Plattformen und ihre Besonderheiten." :
                        "Social Media für Markenbildung und Kundenbindung nutzen.",
                    learningGoals: generateLearningGoals ? [
                        "Die richtige Social Media Plattform für Ihr Business wählen",
                        "Engaging Content erstellen",
                        "Community-Management betreiben"
                    ] : [],
                    quiz: generateQuiz ? [
                        {
                            question: "Wofür ist Social Media Marketing besonders wichtig?",
                            options: ["Nur für Verkäufe", "Markenbildung und Kundenbindung", "Nur für große Unternehmen", "Ausschließlich für B2C"],
                            correct: 1,
                            explanation: "Social Media Marketing ist besonders wichtig für die Markenbildung und Kundenbindung."
                        }
                    ] : []
                }
            ];

            return {
                title,
                transcript: mockTranscript,
                chapters,
                totalDuration: chapters.length * chapterLength
            };
        }

        function showResults(courseData) {
            currentCourse = courseData;
            
            document.getElementById('processingScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            const resultsContainer = document.getElementById('courseResults');
            resultsContainer.innerHTML = `
                <div class="bg-blue-50 p-6 rounded-lg mb-6">
                    <h4 class="text-xl font-bold text-blue-800 mb-4">${courseData.title}</h4>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <strong>Kapitel:</strong> ${courseData.chapters.length}
                        </div>
                        <div>
                            <strong>Gesamtdauer:</strong> ${courseData.totalDuration} Minuten
                        </div>
                        <div>
                            <strong>Lernziele:</strong> ${courseData.chapters.reduce((sum, ch) => sum + ch.learningGoals.length, 0)}
                        </div>
                        <div>
                            <strong>Quiz-Fragen:</strong> ${courseData.chapters.reduce((sum, ch) => sum + ch.quiz.length, 0)}
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    ${courseData.chapters.map((chapter, index) => `
                        <div class="border rounded-lg p-4">
                            <h5 class="font-bold text-lg mb-2">Kapitel ${index + 1}: ${chapter.title}</h5>
                            <p class="text-gray-600 mb-3">${chapter.summary}</p>
                            
                            ${chapter.learningGoals.length > 0 ? `
                                <div class="mb-3">
                                    <strong class="text-sm">Lernziele:</strong>
                                    <ul class="list-disc list-inside text-sm text-gray-600 mt-1">
                                        ${chapter.learningGoals.map(goal => `<li>${goal}</li>`).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                            
                            ${chapter.quiz.length > 0 ? `
                                <div class="text-sm">
                                    <strong>Quiz-Beispiel:</strong>
                                    <p class="italic mt-1">"${chapter.quiz[0].question}"</p>
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>

                <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="downloadPDF('transcript')" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 text-sm">
                        <i class="fas fa-file-pdf mr-2"></i>Transkript PDF
                    </button>
                    <button onclick="downloadPDF('course')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 text-sm">
                        <i class="fas fa-file-pdf mr-2"></i>Kursskript PDF
                    </button>
                    <button onclick="downloadPDF('quiz')" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 text-sm">
                        <i class="fas fa-file-pdf mr-2"></i>Quiz PDF
                    </button>
                    <button onclick="downloadPDF('goals')" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 text-sm">
                        <i class="fas fa-file-pdf mr-2"></i>Lernziele PDF
                    </button>
                </div>
            `;
        }

        function downloadPDF(type) {
            if (!currentCourse) return;

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            switch (type) {
                case 'transcript':
                    generateTranscriptPDF(doc, currentCourse);
                    break;
                case 'course':
                    generateCoursePDF(doc, currentCourse);
                    break;
                case 'quiz':
                    generateQuizPDF(doc, currentCourse);
                    break;
                case 'goals':
                    generateGoalsPDF(doc, currentCourse);
                    break;
            }
        }

        function generateTranscriptPDF(doc, course) {
            doc.setFontSize(20);
            doc.text('Transkript: ' + course.title, 20, 30);
            
            doc.setFontSize(12);
            const splitText = doc.splitTextToSize(course.transcript, 170);
            doc.text(splitText, 20, 50);
            
            doc.save(`${course.title}_Transkript.pdf`);
        }

        function generateCoursePDF(doc, course) {
            doc.setFontSize(20);
            doc.text('Kursskript: ' + course.title, 20, 30);
            
            let y = 50;
            doc.setFontSize(14);
            
            course.chapters.forEach((chapter, index) => {
                if (y > 250) {
                    doc.addPage();
                    y = 30;
                }
                
                doc.setFont(undefined, 'bold');
                doc.text(`Kapitel ${index + 1}: ${chapter.title}`, 20, y);
                y += 15;
                
                doc.setFont(undefined, 'normal');
                doc.setFontSize(12);
                const summaryText = doc.splitTextToSize(chapter.summary, 170);
                doc.text(summaryText, 20, y);
                y += summaryText.length * 5 + 10;
                
                if (chapter.learningGoals.length > 0) {
                    doc.setFont(undefined, 'bold');
                    doc.text('Lernziele:', 20, y);
                    y += 10;
                    
                    doc.setFont(undefined, 'normal');
                    chapter.learningGoals.forEach(goal => {
                        const goalText = doc.splitTextToSize(`• ${goal}`, 165);
                        doc.text(goalText, 25, y);
                        y += goalText.length * 5 + 3;
                    });
                    y += 5;
                }
                
                y += 10;
            });
            
            doc.save(`${course.title}_Kursskript.pdf`);
        }

        function generateQuizPDF(doc, course) {
            doc.setFontSize(20);
            doc.text('Quiz: ' + course.title, 20, 30);
            
            let y = 50;
            let questionNumber = 1;
            
            course.chapters.forEach(chapter => {
                chapter.quiz.forEach(question => {
                    if (y > 240) {
                        doc.addPage();
                        y = 30;
                    }
                    
                    doc.setFontSize(12);
                    doc.setFont(undefined, 'bold');
                    doc.text(`${questionNumber}. ${question.question}`, 20, y);
                    y += 10;
                    
                    doc.setFont(undefined, 'normal');
                    question.options.forEach((option, index) => {
                        const letter = String.fromCharCode(65 + index);
                        doc.text(`${letter}) ${option}`, 25, y);
                        y += 8;
                    });
                    
                    y += 5;
                    doc.setFont(undefined, 'italic');
                    doc.text(`Antwort: ${String.fromCharCode(65 + question.correct)}`, 20, y);
                    y += 8;
                    const explanationText = doc.splitTextToSize(`Erklärung: ${question.explanation}`, 170);
                    doc.text(explanationText, 20, y);
                    y += explanationText.length * 5 + 15;
                    
                    questionNumber++;
                });
            });
            
            doc.save(`${course.title}_Quiz.pdf`);
        }

        function generateGoalsPDF(doc, course) {
            doc.setFontSize(20);
            doc.text('Lernziele: ' + course.title, 20, 30);
            
            let y = 50;
            
            course.chapters.forEach((chapter, index) => {
                if (chapter.learningGoals.length > 0) {
                    if (y > 250) {
                        doc.addPage();
                        y = 30;
                    }
                    
                    doc.setFontSize(14);
                    doc.setFont(undefined, 'bold');
                    doc.text(`Kapitel ${index + 1}: ${chapter.title}`, 20, y);
                    y += 15;
                    
                    doc.setFontSize(12);
                    doc.setFont(undefined, 'normal');
                    chapter.learningGoals.forEach(goal => {
                        const goalText = doc.splitTextToSize(`• ${goal}`, 165);
                        doc.text(goalText, 25, y);
                        y += goalText.length * 5 + 3;
                    });
                    y += 10;
                }
            });
            
            doc.save(`${course.title}_Lernziele.pdf`);
        }

        function downloadAllFiles() {
            if (!currentCourse) return;
            
            setTimeout(() => downloadPDF('transcript'), 100);
            setTimeout(() => downloadPDF('course'), 1000);
            setTimeout(() => downloadPDF('quiz'), 2000);
            setTimeout(() => downloadPDF('goals'), 3000);
        }

        function createNewCourse() {
            resetUploadForm();
            showUpload();
        }

        function resetUploadForm() {
            document.getElementById('uploadForm').classList.remove('hidden');
            document.getElementById('processingScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('fileInfo').classList.add('hidden');
            document.getElementById('courseTitle').value = '';
            document.getElementById('videoFile').value = '';
            selectedFile = null;
            currentCourse = null;
        }

        // Settings functions
        function loadSettings() {
            const openaiKey = localStorage.getItem('openaiKey') || '';
            const summaryStyle = localStorage.getItem('summaryStyle') || 'detailed';
            
            document.getElementById('openaiKey').value = openaiKey;
            document.getElementById('summaryStyle').value = summaryStyle;
        }

        function saveSettings() {
            const openaiKey = document.getElementById('openaiKey').value;
            const summaryStyle = document.getElementById('summaryStyle').value;
            
            localStorage.setItem('openaiKey', openaiKey);
            localStorage.setItem('summaryStyle', summaryStyle);
            
            alert('Einstellungen gespeichert!');
        }
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"96b234aafee40686","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.7.0","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDu2y9L%2FB138EBdIxRp%2FZW%2FirASd2zEQiWGmNBd0k0vs%2FkvZpoOezwAVVfmQPmzVGPvfvbhf4uU0g8LiDLB%2Fi9skIgO7nabNmN6kkGu7FpwIG%2F3CskhwT7FbNlSpS1mS2mNOwTK1d5tAI0FkzUwzvQ81S13vOLEIzYhvplXuUMqmsTgvWdKv7n5Heb%2FWKqBJAhHxzVIbAGRQwOhVwdkNY2dAMcDHpb4f1ls0n%2B04%2FIJUOCYW3iqtm%2BYEGpW65pN4WZsMzx%2BGTWy11%2FebOmXEn1geY5kbD8jq2UFhABQkdKgtwfD16944N94ynmsArECro7x%2FfmsPUaXMEPe46P84x5ke3NLF6NLBUXBHW5YrxI0RPCZ9OZZHm0CootUcxgWu7lrlcra97oTidbVOhHw70Xge6fF9vMAAJFkP66TI587ruQyGWb3u3Xl0b%2F0UdWrQXba1XCZS9UAjlrFkzM0qjC7D%2FQnfCYlLtuV%2BgRfWeHlLASjmWSZHv%2BnHnDm6IuqIoDAQSdRPEfLqIc4GR9Jadebc%3D";
        window.__genspark_locale = "de-DE";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDu2y9L/B138EBdIxRp/ZW/irASd2zEQiWGmNBd0k0vs/kvZpoOezwAVVfmQPmzVGPvfvbhf4uU0g8LiDLB/i9skIgO7nabNmN6kkGu7FpwIG/3CskhwT7FbNlSpS1mS2mNOwTK1d5tAI0FkzUwzvQ81S13vOLEIzYhvplXuUMqmsTgvWdKv7n5Heb/WKqBJAhHxzVIbAGRQwOhVwdkNY2dAMcDHpb4f1ls0n+04/IJUOCYW3iqtm+YEGpW65pN4WZsMzx+GTWy11/ebOmXEn1geY5kbD8jq2UFhABQkdKgtwfD16944N94ynmsArECro7x/fmsPUaXMEPe46P84x5ke3NLF6NLBUXBHW5YrxI0RPCZ9OZZHm0CootUcxgWu7lrlcra97oTidbVOhHw70Xge6fF9vMAAJFkP66TI587ruQyGWb3u3Xl0b/0UdWrQXba1XCZS9UAjlrFkzM0qjC7D/QnfCYlLtuV+gRfWeHlLASjmWSZHv+nHnDm6IuqIoDAQSdRPEfLqIc4GR9Jadebc=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
